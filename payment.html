<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Payment & Receipt</title>

<style>
body{
  background:#020617;
  color:#e5e7eb;
  font-family:Arial, sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

.box{
  background:#0f172a;
  padding:22px;
  width:420px;
  border-radius:10px;
  box-shadow:0 0 25px rgba(0,0,0,.6);
}

h2{
  text-align:center;
  margin-bottom:12px;
}

.option{
  border:1px solid #334155;
  padding:10px;
  margin:8px 0;
  border-radius:6px;
  cursor:pointer;
}
.option:hover{
  background:#1e293b;
}

.details{
  display:none;
  margin-top:6px;
}

input{
  width:100%;
  padding:8px;
  margin:6px 0;
  border-radius:6px;
  border:none;
}

button{
  width:100%;
  padding:10px;
  margin-top:10px;
  background:#22c55e;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-size:15px;
}

.btn-blue{ background:#2563eb; }
.btn-red{ background:#ef4444; }

.amount{
  text-align:center;
  font-size:18px;
  margin-bottom:8px;
}

/* Receipt */
.receipt{
  display:none;
  font-size:14px;
}
.receipt hr{
  border:1px dashed #334155;
  margin:10px 0;
}
.item{
  display:flex;
  justify-content:space-between;
  margin:6px 0;
}
.small{
  font-size:12px;
  color:#9ca3af;
}
.actions{
  display:flex;
  gap:10px;
}
</style>
</head>

<body>

<!-- ================= PAYMENT ================= -->
<div class="box" id="paymentBox">
  <h2>Payment</h2>

  <div class="amount">
    Amount: ‚Çπ<span id="amt">0</span>
  </div>

  <div class="option" onclick="selectPayment('UPI')">üì± UPI</div>
  <div class="details" id="upiBox">
    <input placeholder="Enter UPI ID">
  </div>

  <div class="option" onclick="selectPayment('CARD')">üí≥ Card</div>
  <div class="details" id="cardBox">
    <input placeholder="Card Number">
    <input placeholder="Expiry MM/YY">
    <input placeholder="CVV">
  </div>

  <div class="option" onclick="selectPayment('CASH')">üíµ Cash</div>
  <div class="details" id="cashBox">
    <p>Collect cash from customer</p>
  </div>

  <button onclick="confirmPayment()">Confirm Payment</button>
</div>

<!-- ================= RECEIPT ================= -->
<div class="box receipt" id="receiptBox">
  <h2>üßæ Bill Receipt</h2>

  <p><strong>Date:</strong> <span id="billDate"></span></p>
  <p><strong>Payment Mode:</strong> <span id="payMode"></span></p>

  <hr>

  <div id="receiptItems"></div>

  <hr>

  <p><strong>Total Paid:</strong> ‚Çπ<span id="receiptAmount"></span></p>

  <div class="actions">
    <button class="btn-blue" onclick="printReceipt()">üñ® Print</button>
    <button class="btn-red" onclick="discardReceipt()">‚ùå Discard</button>
  </div>
</div>

<script>
/* LOAD DATA */
const amount = sessionStorage.getItem("payAmount") || 0;
const cart = JSON.parse(sessionStorage.getItem("cartData") || "[]");

document.getElementById("amt").innerText = amount;
document.getElementById("receiptAmount").innerText = amount;
document.getElementById("billDate").innerText = new Date().toLocaleString();

let paymentMode = "";

/* PAYMENT OPTION HANDLER */
function selectPayment(mode){
  paymentMode = mode;
  document.getElementById("payMode").innerText = mode;

  // hide all
  document.querySelectorAll(".details").forEach(d=>d.style.display="none");

  if(mode==="UPI") document.getElementById("upiBox").style.display="block";
  if(mode==="CARD") document.getElementById("cardBox").style.display="block";
  if(mode==="CASH") document.getElementById("cashBox").style.display="block";
}

/* CONFIRM PAYMENT */
function confirmPayment(){
  if(!paymentMode){
    alert("Please select payment method");
    return;
  }

  document.getElementById("paymentBox").style.display="none";
  document.getElementById("receiptBox").style.display="block";

  renderReceipt();
  sessionStorage.setItem("paymentDone","yes");
}

/* RENDER RECEIPT ITEMS */
function renderReceipt(){
  const container = document.getElementById("receiptItems");
  container.innerHTML = "";

  if(cart.length === 0){
    container.innerHTML = "<p class='small'>No items</p>";
    return;
  }

  cart.forEach(item=>{
    const row = document.createElement("div");
    row.className = "item";
    row.innerHTML = `
      <div>
        ${item.name}
        <div class="small">${item.qty} √ó ‚Çπ${item.price}</div>
      </div>
      <div>‚Çπ${(item.qty * item.price).toFixed(2)}</div>
    `;
    container.appendChild(row);
  });
}

/* PRINT */
function printReceipt(){
  window.print();
  goBack();
}

/* DISCARD */
function discardReceipt(){
  if(confirm("Discard receipt?")){
    goBack();
  }
}

/* BACK TO BILLING */
function goBack(){
  sessionStorage.removeItem("payAmount");
  sessionStorage.removeItem("cartData");
  window.location.href="index.html";
}
</script>

</body>
</html>
